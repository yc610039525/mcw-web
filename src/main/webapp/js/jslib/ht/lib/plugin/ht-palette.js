!function(a,b){"use strict";var c="px",d="0",e="innerHTML",f="className",g=ht.Default,h=/msie 9/.test(a.navigator?a.navigator.userAgent.toLowerCase():""),i=null,j=function(){return document},k=function(a){return j().createElement(a)},l=function(){return k("div")},m=function(a,b,c){a.style.setProperty(b,c,i)},n=function(a,b,c){g.def(ht.widget[a],b,c)},o=function(a,b){a.appendChild(b)},p=function(a,b){a.removeChild(b)},q=function(a,b,c,d){a.addEventListener(b,c,!!d)};ht.widget.Palette=function(a){function b(a){"max-height"===a.propertyName&&c.iv()}var c=this,d=c._view=l();c._contentDivMap={},c._uiMap={},c._dirtyMap={},c.dm(a?a:new ht.DataModel),d[f]="ht-widget-palette",q(d,"mousedown",function(a){c.handleMouseDown(a)},!0),q(d,"transitionend",b),q(d,"webkitTransitionEnd",b),q(d,"dragstart",function(a){a.dataTransfer.setData("Text","nodeid:"+a.target.nodeid),a.dataTransfer.effectAllowed="all"})},n("Palette",b,{ms_v:1,ms_fire:1,ms_dm:1,ms_sm:1,_createHeaderUI:function(a){var b=this,c=l(),d=l(),g=k("span"),h=k("span");return c[f]="palette-header",c.nodeid=a.getId(),g[f]="icon",d[f]="palette-content",d.nodeid=a.getId(),b._contentDivMap[a.getId()]=d,g[f]+=a.isExpanded()?" expanded-icon":" collapsed-icon",h[e]=a.getName(),o(c,g),o(c,h),[c,d]},_createItemUI:function(a){var b=h&&a.s("draggable")?k("a"):l(),c=l(),d=l(),g=a.s("title");return m(c,"background","url("+a.getImage()+") no-repeat"),m(c,"background-size","90% 90%"),m(c,"background-position","center center"),o(b,c),o(b,d),b[f]="palette-item",b.nodeid=a.getId(),g&&(b.title=g),d[e]=a.getName(),d[f]="label-box",c[f]="image-box",a.s("draggable")&&(h?(b.href="#",m(b,"text-decoration","none")):b.draggable="true"),b},validateImpl:function(){var a=this,b=a._contentDivMap,g=a._uiMap,i=a._dirtyMap,j=a._view,k=a.dm();for(var l in i){var n=i[l];if(k.contains(n))if(n instanceof ht.Group){var q=a._createHeaderUI(n),r=g[n.getId()];if(r){var s=r.nextSibling;p(j,s),p(j,r)}var t=k.getSiblings(n).indexOf(n),u=j.children[2*t];u?(j.insertBefore(q[0],u),j.insertBefore(s||q[1],u)):(o(j,q[0]),o(j,s||q[1])),g[n.getId()]=q[0],b[n.getId()]=s||q[1]}else{var v=n.getParent();if(v){var w=a._createItemUI(n),x=g[n.getId()],y=b[v.getId()];x&&p(x.parentNode,x);var t=k.getSiblings(n).indexOf(n),z=y.children[t];z?y.insertBefore(w,z):o(y,w),g[n.getId()]=w}}else{var A=g[n.getId()],B=A.parentNode;if(n instanceof ht.Group){var C=A.nextSibling;p(j,A),p(j,C),delete b[n.getId()]}else if(p(B,A),0===B.children.length){var v=k.getDataById(B.nodeid);B[e]=v.s("promptText")}delete g[n.getId()]}}a._dirtyMap={};for(var D in b){var y=b[D],E=y.previousSibling;k.getDataById(b[D].nodeid).isExpanded()?(m(y,"padding-bottom","10px"),m(y,"max-height",y.scrollHeight+c),h&&setTimeout(function(a){return function(){m(a,"max-height",a.scrollHeight+c)}}(y),0),E.children[0][f]="icon expanded-icon"):(m(y,"padding-bottom",d),m(y,"max-height",d),E.children[0][f]="icon collapsed-icon")}},handleMouseDown:function(a){for(var b=this,c=a.target,d=b.sm(),e=b.dm(),g="palette-header",h="palette-item";c&&(c[f]||"").indexOf(g)<0&&(c[f]||"").indexOf(h)<0;)c=c.parentNode;if(c&&c[f].indexOf(g)>=0){var i=c.nodeid,j=e.getDataById(i);j.isExpanded()?j.setExpanded(!1):j.setExpanded(!0)}else if(c&&c[f].indexOf(h)>=0){var i=c.nodeid,k=e.getDataById(i);d.size()>0&&k!==d.ld()&&(b._uiMap[d.ld().getId()][f]=h),d.ss(k),b._uiMap[k.getId()][f]=h+" selected-palette-item"}},setDataModel:function(a){var b=this,c=b._dataModel,d=b._selectionModel;c!==a&&(c&&(c.umm(b.handleDataModelChange,b),c.umd(b.handleDataPropertyChange,b),c.umh(b.handleHierarchyChange,b),d||c.sm().ums(b.handleSelectionChange,b)),b._dataModel=a,a.mm(b.handleDataModelChange,b),a.md(b.handleDataPropertyChange,b),a.mh(b.handleHierarchyChange,b),d?d._setDataModel(a):a.sm().ms(b.handleSelectionChange,b),b.sm().setSelectionMode("single"),b.fp("dataModel",c,a))},handleDataModelChange:function(a){var b=this,c=b._view,d=a.data,f=b._dirtyMap;"add"===a.kind?f[d.getId()]=d:"remove"===a.kind?f[d.getId()]=d:"clear"===a.kind&&(b._uiMap={},b._contentDivMap={},b._dirtyMap={},c[e]=""),b.iv()},handleHierarchyChange:function(a){var b=this,c=a.data;b._dirtyMap[c.getId()]=c,b.iv()},handleDataPropertyChange:function(a){var b=this,c=a.data,d=a.property;"expanded"===d?b.iv():(b._dirtyMap[c.getId()]=c,b.iv())},handleSelectionChange:function(){}})}(this,Object);