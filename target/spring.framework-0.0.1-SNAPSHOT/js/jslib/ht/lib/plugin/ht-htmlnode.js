!function(a){"use strict";var b=function(){return document},c=function(){return b().body},d=function(a,b,c){a.style.setProperty(b,c,null)},e=function(a){return b().createElement(a)},f=function(){return e("div")},g=function(a,b){d(a,"-webkit-transform",b),d(a,"-ms-transform",b),d(a,"transform",b)},h=function(a,b){d(a,"-webkit-transform-origin",b),d(a,"-ms-transform-origin",b),d(a,"transform-origin",b)},i=function(a,b){a.appendChild(b)},j=function(a,b){a.removeChild(b)},k=Math.PI,l="white-space",m="visibility",n="left",o="top",p="width",q="height",r="position",s="display",t="z-index",u="px",v="0 0",w="absolute",x="visible",y="hidden",z="none",A="block",B="nowrap",C="rgba(0,0,0,0.005)",D=ht.graph.GraphView.prototype,E=D.draw;D.adjustHtmlNodeIndex=!0,D.draw=function(a,b){if(E.call(this,a,b),this.adjustHtmlNodeIndex)for(var c=this.getDataModel()._datas._as,e=c.length,f=1,g=0;e>g;g++){var h=c[g];if(h instanceof G){var i=this.getDataUI(h);d(i._contentDiv,t,f+""),d(i._draggerDiv,t,f+1+""),f+=2}}};var F=ht.HtmlNodeUI=function(a,b){var c=this;F.superClass.constructor.call(c,a,b);var e=c._contentDiv=f(),g=c._draggerDiv=f();d(e,r,w),d(e,m,y),d(e,l,B),g.draggable=!1,d(g,"background","url("+b.getDraggerImage()+") no-repeat"),d(g,"background-size","100% 100%"),d(g,p,b.getDraggerImageWidth()+u),d(g,q,b.getDraggerImageHeight()+u),d(g,r,w),d(g,s,z),h(g,v),e.addEventListener("change",function(a){var d=a.target,e=d.bind||d.getAttribute("bind"),f=d.type&&"checkbox"===d.type?d.checked:d.value,g=b.getContext();e&&g&&(g[e]=f,c._contextJSON=JSON.stringify(g))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(a){e.addEventListener(a,this.stopPropagation.bind(this))},c)};ht.Default.def(F,ht.graph.NodeUI,{drawBody:function(a){F.superClass.drawBody.call(this,a);var b=this,c=b._data,e=c._padding,h=2*e,j=b._contentDiv,l=b._draggerDiv,v=b.gv,y=v.getZoom(),B=v.getTranslateX(),D=v.getTranslateY(),E=v.getView(),G=b._nodeInfo,H=c._width,I=c._height,J=G.position,K=G.rotation,L=(H-h)/c._originDivWidth*y,M=(I-h)/c._originDivHeight*y,N=b._html,O=c._html,P=c.getHtmlType();if("html"===P){var Q=c.getContext()||{},R=b._contextJSON,S=c._template,T=JSON.stringify(Q);N&&R&&N===O&&R===T||(b._contextJSON=T,b._html=O,j.innerHTML=S?S(Q):O)}else if(null!=P){var U=c.getHtml();"ht"===P&&(U=U.getView()),N&&N===U||(b._html=U,j.innerHTML="",i(j,U))}if(!j.parentNode){var V=v.htmlNodeDiv;if(!V){var W=f();d(W,r,w),d(W,t,"0"),V=v.htmlNodeDiv=W;var X=v._canvas.nextSibling;X?E.insertBefore(W,X):i(E,W)}i(V,j),i(V,l)}if(c._scalable){var Y=c._originDivWidth,Z=c._originDivHeight;g(j,"rotate("+180*(K/k)+"deg) scale("+L+","+M+")"),d(j,n,(J.x-Y/y/2)*y+B+u),d(j,o,(J.y-Z/y/2)*y+D+u)}else{var $=parseInt(j.style.width),_=parseInt(j.style.height),ab=parseInt((H-h)*y),bb=parseInt((I-h)*y),cb="100%",db=j.children[0];d(db,p,cb),d(db,q,cb),($!==ab||_!==bb)&&(d(j,p,ab+u),d(j,q,bb+u),"ht"===P&&O.invalidate()),g(j,"rotate("+180*(K/k)+"deg)"),d(j,n,(J.x-ab/y/2)*y+B+u),d(j,o,(J.y-bb/y/2)*y+D+u)}var eb=b.dragRect;v.isMovable(c)&&v.isSelected(c)&&eb?(a.save(),a.fillStyle=C,a.fillRect(eb.x,eb.y,eb.width,eb.height),a.restore(),d(l,n,eb.x*y+B+u),d(l,o,eb.y*y+D+u),g(l,"scale("+y+","+y+")"),d(l,s,A)):d(l,s,z),d(j,m,x)},dispose:function(){var a=this.gv.htmlNodeDiv;a.removeChild(this._contentDiv),a.removeChild(this._draggerDiv)},onVisibleChanged:function(a){d(this._contentDiv,m,a?x:y),d(this._draggerDiv,s,a?A:z)},prepareCreateBounds:function(){var a=this,b=a._data;F.superClass.prepareCreateBounds.call(a);var c=b.getRect();a.dragRect={x:c.x+c.width+b._padding,y:c.y+10,width:b.getDraggerImageWidth(),height:b.getDraggerImageHeight()},a.addRect(a.dragRect)},stopPropagation:function(a){if("mousedown"===a.type||"touchstart"===a.type){var b=this.gv,c=b.sm(),d=this._data;ht.Default.isCtrlDown(a)?c.co(d)?c.removeSelection(d):c.appendSelection(d):c.co(d)||c.setSelection(d)}a.stopPropagation()}});var G=ht.HtmlNode=function(){G.superClass.constructor.call(this)};ht.Default.def(G,ht.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:ht.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(b){var c=this,d=c._html;c._html=b,"html"===c.getHtmlType()&&"Handlebars"in a&&(c._template=Handlebars.compile(b)),c._calculateNodeSize(),c.fp("html",d,b)},setContext:function(a){var b=this,c=b._context;b._context=a,b.fp("context",c,a),b._calculateNodeSize()},setScalable:function(a){var b=this,c=b._scalable;b._scalable=a,b.fp("scalable",c,a),b._calculateNodeSize()},getHtmlType:function(){var a=this._html;return a?"string"==typeof a?"html":a.getView?"ht":"dom":null},_calculateNodeSize:function(){var a=this,b=a._html,e=a._template;if(b){var g=f(),h=!1,k=a.getHtmlType();if(d(g,r,w),d(g,l,B),d(g,m,y),"html"===k?(g.innerHTML=e?e(a.getContext()||{}):b,h=!0):"ht"===k?(i(g,b.getView()),h=!0):"dom"===k&&(i(g,b),h=!0),h){var n=2*a._padding;i(c(),g),a._originDivWidth=g.scrollWidth,a._originDivHeight=g.scrollHeight,a._width=a._originDivWidth+n,a._height=a._originDivHeight+n,a._originWidth=a._width,a._originHeight=a._height,j(c(),g)}}},getUIClass:function(){return ht.HtmlNodeUI}})}(this,Object);